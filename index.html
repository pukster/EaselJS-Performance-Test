<html>
    
    <head>

	<!-- Import EaselJS Framework -->
	<script src="EaselJS_v0_3_2/src/easeljs/utils/UID.js"></script>
	<script src="EaselJS_v0_3_2/src/easeljs/geom/Matrix2D.js"></script>
	<script src="EaselJS_v0_3_2/src/easeljs/events/MouseEvent.js"></script>
	<script src="EaselJS_v0_3_2/src/easeljs/display/SpriteSheet.js"></script>
	<script src="EaselJS_v0_3_2/src/easeljs/display/Shadow.js"></script>
	<script src="EaselJS_v0_3_2/src/easeljs/display/DisplayObject.js"></script>
	<script src="EaselJS_v0_3_2/src/easeljs/display/Container.js"></script>
	<script src="EaselJS_v0_3_2/src/easeljs/display/Stage.js"></script>
	<script src="EaselJS_v0_3_2/src/easeljs/display/Bitmap.js"></script>
	<script src="EaselJS_v0_3_2/src/easeljs/display/BitmapSequence.js"></script>
	<script src="EaselJS_v0_3_2/src/easeljs/display/Graphics.js"></script>
	<script src="EaselJS_v0_3_2/src/easeljs/display/Shape.js"></script>
	<script src="EaselJS_v0_3_2/src/easeljs/display/Text.js"></script>
	<script src="EaselJS_v0_3_2/src/easeljs/utils/Ticker.js"></script>
	<!-- End EaselJS Imports -->
        <script type="text/javascript">

            
            shadowOn=false;     //toggle shadow on/off to see performance drop
            tickOn=false;
		cacheOn=false;
		alphaOn=false;
		r=30;
		shadow=10;
		cols=10;
		rows=4;

            function init(){
			canvas=document.getElementById('canvas1');    //get the canvas element from HTML
			
			canvas.height=1000;
			canvas.width=1750;

		      stage = new Stage(canvas);
		      stage.enableMouseOver(50);
		      
		      stage.x=0;
		      stage.y=0;
		      stage.mouseEnabled = true;
            }
            
		function MyContainer(x,y){
			container=new Container();
			container.x=x;
			container.y=y;
			container.addChild(new Circle());
		
			if (cacheOn){
				//PROBLEM 1: UNCOMMENT BELOW TO REMOVE PROBLEM
				container.cache(container.x , container.y , 3*r+1.5*shadow , 3*r+1.5*shadow);
			}
		      container.onMouseOver=function(){
				var circle=this.getChildAt(0);
				circle.graphics=new Graphics();
				circle.graphics.beginFill(circle.cOver).drawCircle(r+1.5*shadow,r+1.5*shadow,r);
			
				if (cacheOn){
					//PROBLEM 2: UNCOMMENT BELOW TO REMOVE PROBLEM
					this.cache(this.x , this.y , 3*r+1.5*shadow , 3*r+1.5*shadow);
				}

				if (!tickOn){stage.update();}
		      }
		      container.onMouseOut=function(){
				var circle=this.getChildAt(0);
				circle.graphics=new Graphics();
				circle.graphics.beginFill(circle.cOut).drawCircle(r+1.5*shadow,r+1.5*shadow,r);

				if (cacheOn){
					//PROBLEM 3: UNCOMMENT BELOW TO REMOVE PROBLEM
					this.cache(this.x , this.y , 3*r+1.5*shadow , 3*r+1.5*shadow);
				}
				if (!tickOn){stage.update();}
		      }

			return container;
		}

		function Circle(){
		      var circle = new Shape();
		      circle.mouseEnabled = true;
			if (!alphaOn){	//if transparency values are not allowed, set alpha values to 1
				AOver=1.0;
				AOut=1.0;
			}
			else{
				AOver=1.0;
				AOut=0.7;
			}
			circle.cOut=Graphics.getRGB(255,0,255,AOut);
			circle.cOver=Graphics.getRGB(0,255,0,AOver);
		      circle.graphics.beginFill(circle.cOut).drawCircle(r+1.5*shadow,r+1.5*shadow,r);

		      if (shadowOn){
		      	circle.shadow=new Shadow("rgba(0,0,0,0.5)",shadow,-shadow,10)    //add a little shadow
		      }
			return circle;
		}

            function test(){

		//stage.addChild(new Circle(200,200,100,100,100,100,0.5,1.0));
		for (var j=1;j<=rows;j++){
			for (var i=0;i<cols;i++){
				stage.addChild(new MyContainer(i*3*r,j*3*r));
				//console.log(i*3*r);
			}
		}

            // add a text object to output the current FPS:
            fpsLabel = new Text("-- fps","bold 18px Arial","rgba(0,0,0,1)");
            stage.addChild(fpsLabel);
            fpsLabel.x = 10;
            fpsLabel.y = 20;
            
		if (!tickOn){
			stage.update();
		}
            else{
		      Ticker.addListener(window);
		      Ticker.setFPS(25);
		}
	}    
            
            function tick() {    
            fpsLabel.text = Math.round(Ticker.getMeasuredFPS())+" fps";
            
		stage.clear();
            // draw the updates to stage:
            stage.update();
            }

		function toggleShadows(){
			shadowOn =!shadowOn; 
			stage.removeAllChildren();
			stage.clear();
			test();
		}

		function toggleCache(){
			cacheOn =!cacheOn; 
			stage.removeAllChildren();
			stage.clear();
			test();
		}

		function toggleAlpha(){
			alphaOn =!alphaOn;
			stage.removeAllChildren();
			stage.clear(); 
			test();
		}

		function toggleTick(){
			if (tickOn){
				Ticker.removeListener(window);
				fpsLabel.text ="-- fps";
				stage.update();
			}
			else{
				Ticker.addListener(window);
			}
			tickOn=!tickOn;
		}
		/*
		function changeFPS(){
			select=document.getElementById('fps')
			Ticker.setFPS(select.options[select.selectedIndex].value)
		}
	
		function changeRows(){
			select=document.getElementById('rows')
			rows=select.options[select.selectedIndex].value
			stage.removeAllChildren();
			stage.clear();

			test();
		}
	
		function changeCols(){
			select=document.getElementById('cols')
			cols=select.options[select.selectedIndex].value
			stage.removeAllChildren();
			stage.clear();

			test();
		}
	
		function changeRadius(){
			select=document.getElementById('radius')
			r=select.options[select.selectedIndex].value
			stage.removeAllChildren();
			stage.clear();
	
			test();
		}
        </script>
    </head>
	<div class="description">
	This example is meant to highlight the performance issues in EaselJS, particularly as how to they effect mouse over transitions.
	<br/><br/>
	<input type="checkbox" onClick="toggleShadows();"/> Shadows
	<input type="checkbox" onClick="toggleCache();"/> Cache
	<input type="checkbox" onClick="toggleAlpha();"/> Alpha
	<input type="checkbox" onClick="toggleTick();"/> Tick (FPS

	<select id="fps" onchange="changeFPS();">
	<option value="2">2</option>
	<option value="10">10</option>
	<option value="25" selected="selected">25</option>
	<option value="50">50</option>
	</select>
	 )
	Rows=

	<select id="rows" onchange="changeRows();">
	<option value="2">2</option>
	<option value="4" selected="selected">4</option>
	<option value="6">6</option>
	<option value="8">8</option>
	<option value="10">10</option>
	<option value="20">20</option>
	</select>
	, Cols=

	<select id="cols" onchange="changeCols();">
	<option value="10" selected="selected">10</option>
	<option value="20">20</option>
	<option value="30">30</option>
	<option value="50">50</option>
	</select>
	 

	</div>
    <body onload="init();test();" bgcolor="yellow">
        <canvas id="canvas1" width="500" height="500"></canvas>
    </body>
    
</html>












